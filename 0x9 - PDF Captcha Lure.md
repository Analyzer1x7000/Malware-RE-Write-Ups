<p align="center"><img src="https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/6c366ffa-4f5f-4808-b791-c80d8a1a2825" width=400 height=400></p>

- This specimen comes in the form of a `.pdf` file with an embedded image that mimics a Captcha prompt.

![Pasted image 20240704233908](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/009b1637-e68b-4d2c-a681-feeed952b4ea)

- After opening the `.pdf` in a sandbox environment, we can proceed to extract a list of objects using `pdfid`.

![Pasted image 20240704234138](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/b310ef03-ac25-41d7-8dcb-b69d7effda90)

- Additionally, we can get a more granular overview of the embedded objects with `pdf-parser`.

![Pasted image 20240704234233](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/2c3d14fc-80d8-4ba3-bd2c-82a94dd28cea)

- Note the presence of multiple URI objects as well as one XObject. In PDFs, XObjects are typically images, forms, or postscript objects. In this case, we can assume at this point that the XObject we found is the fake Captcha image that we found in the sandbox earlier.

- If we use `pdf-parser.py` with the `-s` switch, we can take a closer look at a specific object. Let's start by investigating the URI objects. 

![Pasted image 20240704234506](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/6eaa73ca-d8fd-4fb6-9a3b-d0cc9d3c22f9)

- Immediately, we see a Russian (`.ru`) domain in object #10. 

- If we extract more URI objects, we find that they are harmless AWS and CDN links, etc.

![Pasted image 20240704234612](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/e906118a-b36f-4ee1-9a54-900398a3b290)

- With `pdf-parser.py`, the `-k` switch allows us to extract specifically *clickable* URI objects. This gives us a different output.

![Pasted image 20240704234705](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/7818d565-6975-4da3-9946-2ba806743d6d)

- If we take a closer look at the image object (object #6), we can see that it is indeed an image with width and height specifications, a designated ColorSpace, etc.

![Pasted image 20240704234821](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/721b7f39-5b3e-40c3-a4d8-69011dcb2a32)

- We can use the `-d` switch to extract that image and save it to disk. Next, we can simply view it with the system's native image viewer.

![Pasted image 20240704234930](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/125e6f45-812d-484e-929b-3ec6df143504)

- The image we extracted is indeed the fake Captcha prompt that we saw earlier.

![Pasted image 20240704234947](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/6a5ca85c-a433-4eeb-a6b0-a17fec9142b9)

- The image we extracted is indeed the fake Captcha prompt that we saw earlier.

![Pasted image 20240704234947](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/159b31e8-fb0c-41cb-bb71-97bdef38fbb6)

- Next, we can use the `-r` switch to determine which objects reference the fake captcha image object.

![Pasted image 20240704235045](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/0ad89a3d-6407-4d0d-8056-f598c8341719)

- We can see at the top left that object #13 references it. Digging deeper and following the chain of object references, we end up identifying Object 14 as an Annotations object. In `.pdf` files, annotations are interactive elements that can be added within a PDF document to provide additional functionalities - for example, clickable URLs. 

![Pasted image 20240704235239](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/30ffca88-173d-4d20-94e6-79be8e9e167e)

- We extract object #10 to confirm that it is indeed the clickable Russian URL.

![Pasted image 20240704235428](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/cd29527e-15f1-4eab-9bb6-032b50c0418c)

- Let's open Wireshark and start a packet capture, and then detonate the clickable URI in a sandbox.

- Ironically, we get a security warning from Microsoft Edge. 

![Pasted image 20240704235639](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/4075a656-c88e-4f8c-b787-628aef864ff7)

- But we proceed to the web page regardless. 

![Pasted image 20240704235651](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/2a1685ea-f9dc-4a71-a4da-c94fb4593625)

- And finally, we are met with the default INetSim landing page. 

![Pasted image 20240704235715](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/7b78bb85-5c8f-4587-98bb-f31a21ed6ba5)

- This doesn't really tell the whole story. So instead, if we connect our test machine to the internet and run more comprehensive tools to inspect the HTTP traffic, we actually see multiple redirects until it reaches its target and attempts to download a PE file named `hcv_client-13874.exe`. 

![Pasted image 20240705000242](https://github.com/Analyzer1x7000/Malware-RE-Write-Ups/assets/103800652/cbee35b8-e3e3-4121-a623-c1c37cd0b0a7)
